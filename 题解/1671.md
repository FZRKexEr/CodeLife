# Educational Codeforces Round 127 (Rated for Div. 2) Tutorials

## E - Preorder

一个性质：
1. 这种规范的(层数很低)二叉树, 对每一个点遍历子树，也不会超时, 复杂度是 $n \log n$ 。

这条性质等会可以用到。

考虑状态转移: 

对于一个结点 $x$ ，如果 $l$ 和 $r$ 内部无论怎么交换都不能相同。那么就说明子树 $l$ 和 $r$ 贡献的字符串永远不会相同。对于 $x$ ，考虑实施交换和不交换。$x$ 的答案是:
$$ f(x) = f(l) \times f(r) \times 2$$

如果 $l$ 和 $r$ 能够通过内部交换变得相同。说明 $l$ 和 $r$ 子树构成的字符串的集合是完全相同的。此时的答案是

$$ f(x) = f(l) * f(l) $$

现在唯一的问题就是怎么判断两个子树是否能通过 swap 变得相同。显然把子树 swap 到中序遍历字典序最小，然后比较这两个字典序是否一样就好了。可以对每个子树暴力遍历一遍，复杂度 $O(n \log n)$